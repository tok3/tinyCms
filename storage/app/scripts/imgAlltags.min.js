(()=>{"use strict";var userLang=["en","de","fr","it","da","pl"].includes(document.documentElement.lang.slice(0,2))?document.documentElement.lang.slice(0,2):"de";const scripts=document.getElementsByTagName("script"),currentScript=Array.from(scripts).find((script=>script.src.includes("altstar.js")));let titletag=null;if(currentScript){const queryParams=new URLSearchParams(currentScript.src.split("?")[1]);titletag=queryParams.get("titletag"),"true"!=titletag&&"false"!=titletag&&(titletag=null)}const pathSegments=new URL(document.currentScript.src).pathname.split("/"),ulid=pathSegments[pathSegments.length-2],iniBfUrl=new URL(document.currentScript.src);document.addEventListener("DOMContentLoaded",(()=>{iniBfUrl.pathname.split("/");const images=document.querySelectorAll("img"),imageUrls=Array.from(images).map((img=>{try{let url=new URL(img.getAttribute("src"),window.location.origin);return url.origin+url.pathname}catch(error){return console.warn(`Invalid URL for image: ${img.getAttribute("src")}`,error),null}})).filter((src=>src));0!==imageUrls.length?fetch("https://aktion-barrierefrei.org/imageDescription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:imageUrls,ulid:ulid,lang:userLang})}).then((response=>{if(!response.ok)throw new Error("Network response was not ok");return response.json()})).then((data=>{images.forEach((img=>{let absoluteSrc;try{let urltmp=new URL(img.getAttribute("src"),window.location.origin);absoluteSrc=urltmp.origin+urltmp.pathname}catch(error){return void console.warn(`Skipping invalid image src: ${img.getAttribute("src")}`,error)}const descriptionEntry=data.find((item=>item.url.replace(/\\\//g,"/")===absoluteSrc));descriptionEntry&&descriptionEntry.description?(img.setAttribute("alt",descriptionEntry.description),null===titletag||img.hasAttribute("title")||(img.setAttribute("title",descriptionEntry.description),console.log(`Added title="${descriptionEntry.description}" to image: ${absoluteSrc}`)),console.log(`Added alt="${descriptionEntry.description}" to image: ${absoluteSrc}`)):console.warn(`No description found for image: ${absoluteSrc}`)}))})).catch((error=>{console.error("Error fetching image descriptions:",error)})):console.log("No valid images without alt or aria-label found.")}))})();
